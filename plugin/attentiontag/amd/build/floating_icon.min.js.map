{"version":3,"file":"floating_icon.min.js","sources":["../src/floating_icon.js"],"sourcesContent":["define(['jquery', 'core/log', 'block_attentiontag/attention-tag'], function($, log, attentiontag) {\n    'use strict';\n\n    /**\n     * Floating icon code\n     */\n    function init() {\n        log.debug('AttentionTag block initialized.');\n        attentiontag.init();\n\n        // Show the chat box initially\n        $('.attentiontag-chat-box').fadeIn();\n\n        // Handle \"No\" button click - just hide the chat box and show Deactivated image\n        $('#attentiontag-btn-no').on('click', function() {\n            $('.attentiontag-chat-box').fadeOut();\n            $('#attentiontag-image-initial').show();\n        });\n\n        // Handle \"Yes\" button click - ask for camera permission and change to Wake_up.gif if granted\n        $('#attentiontag-btn-yes').on('click', function() {\n            $('.attentiontag-chat-box').fadeOut();\n\n            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n                navigator.mediaDevices.getUserMedia({ video: true })\n                    .then(function(stream) {\n                        log.debug('Camera access granted.');\n                        stream.getTracks().forEach(track => track.stop()); // Stop the video stream\n\n                        // Switch to the \"Wake_up\" image after permission is granted\n                        $('#attentiontag-image-initial').hide();\n                        $('#attentiontag-image-after-permission').show();\n\n                        // After 15 seconds, switch to the happy face image\n                        setTimeout(function() {\n                            $('#attentiontag-image-after-permission').hide();\n                            $('#attentiontag-image-happy').show();\n\n                            // After 15 more seconds, switch to the sad face image\n                            setTimeout(function() {\n                                $('#attentiontag-image-happy').hide();\n                                $('#attentiontag-image-sad').show();\n\n                                // After another 15 seconds, start shaking the sad face\n                                setTimeout(function() {\n                                    $('#attentiontag-image-sad').addClass('attentiontag-shake');\n                                }, 7000);\n                            }, 7000);\n                        }, 5000); // Delay before showing the happy face\n                    })\n                    .catch(function(err) {\n                        log.debug('Camera access denied: ' + err);\n                    });\n            } else {\n                log.debug('getUserMedia not supported by this browser.');\n                // Handle the case where getUserMedia is not supported\n            }\n        });\n\n        // Handle click event on the sad face image to show the message box and stop shaking\n        $('#attentiontag-image-sad').on('click', function() {\n            $('.attentiontag-message-box').fadeIn();\n\n            // Stop the shaking by removing the class\n            $('#attentiontag-image-sad').removeClass('attentiontag-shake');\n        });\n\n        // Handle click event to close the message box\n        $('.attentiontag-close-button').on('click', function() {\n            $('.attentiontag-message-box').fadeOut();\n        });\n    }\n\n    return {\n        init: init\n    };\n});\n"],"names":["define","$","log","attentiontag","init","debug","fadeIn","on","fadeOut","show","navigator","mediaDevices","getUserMedia","video","then","stream","getTracks","forEach","track","stop","hide","setTimeout","addClass","catch","err","removeClass"],"mappings":"AAAAA,0CAAO,CAAC,SAAU,WAAY,qCAAqC,SAASC,EAAGC,IAAKC,oBAyEzE,CACHC,gBAnEAF,IAAIG,MAAM,mCACVF,aAAaC,OAGbH,EAAE,0BAA0BK,SAG5BL,EAAE,wBAAwBM,GAAG,SAAS,WAClCN,EAAE,0BAA0BO,UAC5BP,EAAE,+BAA+BQ,UAIrCR,EAAE,yBAAyBM,GAAG,SAAS,WACnCN,EAAE,0BAA0BO,UAExBE,UAAUC,cAAgBD,UAAUC,aAAaC,aACjDF,UAAUC,aAAaC,aAAa,CAAEC,OAAO,IACxCC,MAAK,SAASC,QACXb,IAAIG,MAAM,0BACVU,OAAOC,YAAYC,SAAQC,OAASA,MAAMC,SAG1ClB,EAAE,+BAA+BmB,OACjCnB,EAAE,wCAAwCQ,OAG1CY,YAAW,WACPpB,EAAE,wCAAwCmB,OAC1CnB,EAAE,6BAA6BQ,OAG/BY,YAAW,WACPpB,EAAE,6BAA6BmB,OAC/BnB,EAAE,2BAA2BQ,OAG7BY,YAAW,WACPpB,EAAE,2BAA2BqB,SAAS,wBACvC,OACJ,OACJ,QAENC,OAAM,SAASC,KACZtB,IAAIG,MAAM,yBAA2BmB,QAG7CtB,IAAIG,MAAM,kDAMlBJ,EAAE,2BAA2BM,GAAG,SAAS,WACrCN,EAAE,6BAA6BK,SAG/BL,EAAE,2BAA2BwB,YAAY,yBAI7CxB,EAAE,8BAA8BM,GAAG,SAAS,WACxCN,EAAE,6BAA6BO"}